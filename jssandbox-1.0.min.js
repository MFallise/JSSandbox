class JSSandbox{constructor(){this.sampleEnv={queued:!0,code:"$('.my-div').html('Hello World!')",markup:'<div class="my-div"></div>',styles:".my-div {\n\tborder: 4px solid green;\n\tpadding: 20px;\n}"},$(".sandbox .actions .button.export").click(this.onExport.bind(this)),$(".sandbox .actions .button.clear").click(this.onClear.bind(this)),$(".actions .button.run").click(this.onRun.bind(this)),$(".sandbox .editor textarea").keydown(this.onKeydown),$("textarea").on("paste",function(t){t.stopPropagation()}),document.body.addEventListener("paste",this.onPaste.bind(this)),document.body.addEventListener("copy",this.onCopy.bind(this)),this.rendered=!1;const t=new URLSearchParams(window.location.search);let e=t.get("s");e?(t.delete("s"),$.get("/sandboxes/"+e+".json").done(this.onSample.bind(this))):(this.saved=localStorage.getItem("currentEnv"),this.env=this.saved?JSON.parse(this.saved):this.sampleEnv,this.load(this.env))}load(t){$(".markup textarea").val(t.markup),$(".styles textarea").val(t.styles),$(".code textarea").val(t.code),t.queued&&(this.queued=!1,this.save(t),setTimeout(this.launch.bind(this,t),30))}save(t){localStorage.setItem("currentEnv",JSON.stringify(t))}launch(t){t.code=$(".code textarea").val(),t.markup=$(".markup textarea").val(),t.styles=$(".styles textarea").val(),t.queued=!1,this.save(t),this.exec(t)}exec(t){this.rendered?(t.queued=!0,this.save(t),window.location=window.location.href.split("?")[0]):($(".output").empty(),$(".output").append('<style type="text/css">'+t.styles+"</style>"),$(".output").append(t.markup),$(".output").append('<script type="text/javascript">'+t.code+"<\/script>")),this.rendered=!0}onPaste(t){t.stopPropagation(),t.preventDefault();let e=(t.clipboardData||window.clipboardData).getData("Text"),a=JSON.parse(e);this.load(a)}onCopy(t){t.preventDefault(),this.env.code=$(".code textarea").val(),this.env.markup=$(".markup textarea").val(),this.env.styles=$(".styles textarea").val(),this.queued=!1;let e=JSON.stringify(this.env);console.log(e),t.clipboardData?t.clipboardData.setData("text/plain",e):window.clipboardData&&window.clipboardData.setData("Text",e)}onSample(t){this.env=t,this.load(this.env)}onExport(t){t.stopPropagation(),t.preventDefault(),document.execCommand("copy")}onClear(t){t.stopPropagation(),t.preventDefault(),$(".code textarea").val(""),$(".markup textarea").val(""),$(".styles textarea").val("")}onRun(t){t.stopPropagation(),t.preventDefault(),this.launch(this.env)}onKeydown(t){if(9==t.which){t.preventDefault();let e=this.selectionStart,a=this.selectionEnd;this.value=this.value.substring(0,e)+"\t"+this.value.substring(a),this.selectionStart=this.selectionEnd=e+1}}}